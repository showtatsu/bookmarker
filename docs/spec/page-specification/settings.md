# 設定ページ仕様

## 概要

アプリケーションの各種設定を行うページ。

## URL

```
/settings
```

## 認証

**必要**（未ログインの場合は `/login` へリダイレクト）

---

## ページ構成

### レイアウト

```
┌─────────────────────────────────────────────────────────────┐
│  📚 Bookmarker    [ブックマーク] [タグ] [👤] [⚙️] [ログアウト] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  設定                                                       │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 表示設定                                             │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │                                                     │   │
│  │  テーマ                                             │   │
│  │  (●) ライト  ( ) ダーク  ( ) システム設定に従う     │   │
│  │                                                     │   │
│  │  1ページあたりの表示件数                            │   │
│  │  [ 20 ▼ ]                                           │   │
│  │                                                     │   │
│  │  デフォルトのソート順                               │   │
│  │  [ 新しい順 ▼ ]                                     │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ APIトークン                                         │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │                                                     │   │
│  │  外部ツールからBookmarkerにアクセスするための       │   │
│  │  APIトークンを管理します。                          │   │
│  │                                                     │   │
│  │  ┌───────────────────────────────────────────────┐ │   │
│  │  │ CLI用トークン          作成日: 2026/01/10     │ │   │
│  │  │ 最終使用: 2026/01/15          [ 削除 ]        │ │   │
│  │  └───────────────────────────────────────────────┘ │   │
│  │                                                     │   │
│  │  ┌───────────────────────────────────────────────┐ │   │
│  │  │ VS Code拡張用          作成日: 2026/01/05     │ │   │
│  │  │ 最終使用: 2026/01/16          [ 削除 ]        │ │   │
│  │  └───────────────────────────────────────────────┘ │   │
│  │                                                     │   │
│  │                        [ + 新しいトークンを作成 ]   │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ データ管理                                          │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │                                                     │   │
│  │  エクスポート                                       │   │
│  │  ブックマークとタグをJSON形式でダウンロードします。 │   │
│  │                              [ エクスポート ]       │   │
│  │                                                     │   │
│  │  インポート                                         │   │
│  │  JSON形式のファイルからブックマークを読み込みます。 │   │
│  │                              [ インポート ]         │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                                    [ 設定を保存 ]           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 設定項目

### 1. 表示設定

| 項目 | 型 | 選択肢 | デフォルト |
|------|-----|--------|-----------|
| theme | radio | light / dark / system | system |
| itemsPerPage | select | 10 / 20 / 50 / 100 | 20 |
| defaultSort | select | created_at desc / created_at asc / title asc / title desc | created_at desc |

### 2. APIトークン管理

| 項目 | 説明 |
|------|------|
| トークン名 | 識別用の名前 |
| 作成日 | トークン作成日時 |
| 最終使用日 | 最後にAPIアクセスした日時 |
| 有効期限 | トークンの有効期限（オプション） |

### 3. データ管理

| 機能 | 説明 |
|------|------|
| エクスポート | すべてのブックマークとタグをJSON形式でダウンロード |
| インポート | JSON形式のファイルからブックマークを一括登録 |

---

## APIトークン作成モーダル

```
┌─────────────────────────────────────────┐
│  新しいAPIトークンを作成             [×] │
├─────────────────────────────────────────┤
│                                         │
│  トークン名 *                           │
│  ┌─────────────────────────────────┐   │
│  │ CLI用トークン                   │   │
│  └─────────────────────────────────┘   │
│                                         │
│  有効期限                               │
│  [ 無期限 ▼ ]                           │
│  • 無期限                               │
│  • 30日                                 │
│  • 90日                                 │
│  • 1年                                  │
│                                         │
│        [ キャンセル ]  [ 作成 ]         │
└─────────────────────────────────────────┘
```

### トークン作成成功モーダル

```
┌─────────────────────────────────────────┐
│  ✅ トークンが作成されました         [×] │
├─────────────────────────────────────────┤
│                                         │
│  以下のトークンを安全な場所に保存して   │
│  ください。このトークンは二度と表示     │
│  されません。                           │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ bk_xxxxxxxxxxxxxxxxxxxxxxxx     │   │
│  └─────────────────────────────────┘   │
│                                         │
│              [ コピー ]  [ 閉じる ]     │
└─────────────────────────────────────────┘
```

---

## API連携

### 設定取得

```
GET /api/users/me/settings
```

### 設定更新

```
PUT /api/users/me/settings
{
  "theme": "dark",
  "itemsPerPage": 50,
  "defaultSort": "title asc"
}
```

### トークン一覧取得

```
GET /api/tokens
```

### トークン作成

```
POST /api/tokens
{
  "name": "CLI用トークン",
  "expiresIn": null
}
```

### トークン削除

```
DELETE /api/tokens/:id
```

### エクスポート

```
GET /api/bookmarks/export
Content-Type: application/json
```

### インポート

```
POST /api/bookmarks/import
Content-Type: application/json

{
  "bookmarks": [...],
  "tags": [...]
}
```

---

## エクスポートデータ形式

```json
{
  "version": "1.0",
  "exportedAt": "2026-01-17T10:30:00.000Z",
  "bookmarks": [
    {
      "type": "url",
      "title": "Next.js公式ドキュメント",
      "url": "https://nextjs.org/docs",
      "description": "Next.jsの公式ドキュメント",
      "tags": ["JavaScript", "React"],
      "isFavorite": true,
      "createdAt": "2026-01-15T08:00:00.000Z"
    }
  ],
  "tags": ["JavaScript", "React", "設計", "TypeScript"]
}
```

---

## 状態管理

### 設定変更の保存

- 変更があった場合のみ「設定を保存」ボタンを有効化
- 保存成功時にトースト通知を表示
- ページ離脱時に未保存の変更があれば確認ダイアログを表示
